define(["util","ui.widget.modalDialogue"],function(util,modal){var SettingsAssistant=function(options){if(!options.withSettings)throw new Error("Settings Assistant cannot be created with no settings instance.");var settings=this.settings=options.withSettings;this.panes={};for(var pane in settings.dialogueDefinitions)this.addPane(settings.dialogueDefinitions[pane])};return SettingsAssistant.prototype.presentDialogue=function(){var views=[];for(var i in this.panes)views.push(this.panes[i].MDD);views.length>0?this.dialogueId=modal.createMultiView({title:"Settings",views:views,buttons:{apply:{title:"Apply",callback:this.apply,context:this},close:!0},animate:{animateIn:"slideInTop",animateOut:"slideOutTop"}}):console.log("Settings Assistant cannot be run with no panes.")},SettingsAssistant.prototype.dismissDialogue=function(){modal.close(this.dialogueId)},SettingsAssistant.prototype.apply=function(){var form=document.forms[0];if(!(form.name in this.panes))throw new Error("There is no pane registered with that name.");var inputs=document.forms[form.name].elements;this.panes[form.name].applyMethod.call(modal,inputs)},SettingsAssistant.prototype.addPane=function(MDD){MDD.form&&MDD.form.name?this.panes[MDD.form.name]={MDD:MDD,applyMethod:typeof MDD.form.callback=="function"?MDD.form.callback:function(){}}:this.panes[MDD.title]={MDD:MDD,applyMethod:!1}},SettingsAssistant.prototype.removePane=function(name){try{delete this.panes[name]}catch(ex){throw ex}},SettingsAssistant})